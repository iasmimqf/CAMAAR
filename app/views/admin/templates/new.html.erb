<%# app/views/templates/new.html.erb %>
<h1>Novo Template de Formulário</h1>

<%= form_with model: @template, local: true do |f| %>
  <% if @template.errors.any? %>
    <div class="alert alert-danger">
      <ul>
        <% @template.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="mb-3">
    <%= f.label :title, "Título do Template", class: "form-label" %>
    <%= f.text_field :title, class: "form-control", required: true %>
  </div>

  <h3>Questões</h3>
  <div id="questions">
    <%= f.fields_for :questions do |question| %>
      <%= render "question_fields", f: question %>
    <% end %>
  </div>

  <div class="mb-3">
    <%= link_to_add_association "Adicionar Questão", f, :questions,
      class: "btn btn-secondary",
      data: {
        association_insertion_node: '#questions',
        association_insertion_method: :append
      } %>
  </div>

  <%= f.submit "Salvar Template", class: "btn btn-primary", id: "save-template" %>
<% end %>